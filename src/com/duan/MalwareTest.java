package com.duan;

import com.duan.analysis.FunctionsAnalysis;
import com.duan.analysis.PermissionAnalysis;
import com.duan.common.ApkTest;
import com.duan.decompile.Decompiler;
import com.duan.table_manager.SamplesManager;

import java.util.Collection;

/**
 * Created by DuanJiaNing on 2017/4/27.
 */
public class MalwareTest {

    private Collection<?> permissions;
    private Collection<?> functions;

    // APP 恶意性检测入口
    // 运行此方法前应保证：
    // 1. 执行了数据库预处理
    // 2. 待测 APP 的 apk 文件存放到 D:\Decompile\testApks\test_sw 目录下
    // 3. D:\Decompile\testApks\test_sw 目录下除了待测 APP 的 apk 文件外没有其他文件
    @ApkTest("开始检测apk是否为恶意APP")
    public void startDetection() {
        new SamplesManager().checkTest();
        new Decompiler(true,true).decompileAPK();
        permissions = new PermissionAnalysis().analysis().getContainerSet();
        functions = new FunctionsAnalysis().analysis().getContainerSet();

    }

}
